{% extends 'base.html' %} {% block head %}
<title>usecase2ml - search</title>
{% endblock %} {% block body %}
<div class="container">
  <!-- <h1 style="text-align: center">usecase2ml</h1> -->
  <!-- <h2 style="text-align: center">query: {{ query }}</h2> -->
  <!-- <div class="row">
    <form action="/" method="POST" class="form-inline">
      <div class="form-group mx-sm-3 mb-2">
        <label for="search" class="sr-only">Search</label>
        <input
          type="text"
          class="form-control"
          id="search"
          name="search"
          value="{{ query }}"
        />
      </div>
      <button type="submit" class="btn btn-primary mb-2">Search</button>
    </form>
  </div> -->

  <div class="row mt-3">
    <!-- Search Field -->
    <div class="container">
      <form action="/" method="POST">
        <div class="form-group row">
          <div class="col-sm-2">
            <label for="search" class="col-form-label">Search</label>
          </div>
          <div class="col-sm-8">
            <input
              type="text"
              class="form-control form-control-lg"
              id="search"
              name="search"
              value="{{ query.query }}"
            />
          </div>
        </div>

        <!-- Options -->
        <div id="options" class="{{ show_filter }}">
          <!-- Query Engines -->
          <div id="engines" class="">
            <div class="form-group row">
              <div class="col-sm-2">Queries</div>
              <div class="col-sm-10">
                <div>
                  <div class="form-check form-check-inline col-sm-2">
                    <input class="form-check-input" type="checkbox" id="kt"
                    name="kt" {{ query_engines['kt'] }} />
                    <label class="form-check-label" for="gridCheck1">
                      Keyword Title
                    </label>
                  </div>
                  <div class="form-check form-check-inline col-sm-4">
                    <input class="form-check-input" type="checkbox" id="ks"
                    name="ks" {{ query_engines['ks'] }} />
                    <label class="form-check-label" for="gridCheck1">
                      Keyword Summarization
                    </label>
                  </div>
                </div>

                <div>
                  <div class="form-check form-check-inline col-sm-2">
                    <input class="form-check-input" type="checkbox" id="st"
                    name="st" {{ query_engines['st'] }} />
                    <label class="form-check-label" for="gridCheck1">
                      Semantic Title
                    </label>
                  </div>
                  <div class="form-check form-check-inline col-sm-4">
                    <input class="form-check-input" type="checkbox" id="ss"
                    name="ss" {{ query_engines['ss'] }} />
                    <label class="form-check-label" for="gridCheck1">
                      Semantic Summarization
                    </label>
                  </div>
                </div>
                <div>
                  <div class="form-check form-check-inline col-sm-2">
                    <input class="form-check-input" type="radio"
                    id="summarization" name="secondary" value="summarization" {{
                    query_engines['sum'] }} />
                    <label class="form-check-label" for="gridCheck1">
                      Summarization
                    </label>
                  </div>
                  <div class="form-check form-check-inline col-sm-2">
                    <input class="form-check-input" type="radio"
                    id="description" name="secondary" value="description" {{
                    query_engines['des'] }} />
                    <label class="form-check-label" for="gridCheck1">
                      Description
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Embeddings -->
          <div id="embeddings" class="">
            <div class="form-group row">
              <div class="col-sm-2">Embedding</div>
              <div class="col-sm-10">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="model"
                    id="use"
                    value="use"
                    {{
                    use
                    }}
                  />
                  <label class="form-check-label" for="use"> USE4 (DAN) </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="model"
                    id="use_large"
                    value="use_large"
                    {{
                    use_large
                    }}
                  />
                  <label class="form-check-label" for="use_large">
                    USE5 large (Transformer)
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- Filters -->
          <!-- <div id="filter" class="{{ show_filter }}"> -->
          <div id="filter" class="">
            <div class="form-group row">
              <div class="col-sm-2">Filter</div>
              <div class="col-sm-10">
                <div>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-control form-control-sm"
                      type="text"
                      placeholder="tags"
                      id="tags"
                      name="tags"
                      value="{{ query.tags }}"
                    />
                  </div>

                  <div class="form-check form-check-inline">
                    <input
                      class="form-control form-control-sm"
                      type="text"
                      placeholder="kind"
                      id="kind"
                      name="kind"
                      value="{{ query.kind }}"
                    />
                  </div>

                  <div class="form-check form-check-inline">
                    <input
                      class="form-control form-control-sm"
                      type="text"
                      placeholder="ml_libs"
                      id="ml_libs"
                      name="ml_libs"
                      value="{{ query.ml_libs }}"
                    />
                  </div>
                </div>
                <div>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-control form-control-sm"
                      type="text"
                      placeholder="tags not"
                      id="tags_not"
                      name="tags_not"
                      value="{{ query_not.tags }}"
                    />
                  </div>

                  <div class="form-check form-check-inline">
                    <input
                      class="form-control form-control-sm"
                      type="text"
                      placeholder="kind not"
                      id="kind_not"
                      name="kind_not"
                      value="{{ query_not.kind }}"
                    />
                  </div>

                  <div class="form-check form-check-inline">
                    <input
                      class="form-control form-control-sm"
                      type="text"
                      placeholder="ml_libs not"
                      id="ml_libs_not"
                      name="ml_libs_not"
                      value="{{ query_not.ml_libs }}"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Options Toggle -->
        <div class="form-group row">
          <div class="col-sm-2">
            <a onClick="toggle(options); return false;" href="#">More</a>
          </div>
          <!-- <div class="col-sm-2">
            <a onClick="toggle(engines); return false;" href="#">Queries</a>
          </div>
          <div class="col-sm-2">
            <a onClick="toggle(embeddings); return false;" href="#">Embeddings</a>
          </div>
          <div class="col-sm-2">
            <a onClick="toggle(filter); return false;" href="#">Filter</a>
          </div> -->
        </div>

        <!-- Submit -->
        <div class="form-group row">
          <div class="col-sm-2">
            <button type="submit" class="btn btn-primary">Search</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="row">
    <div class="container">
      {% if items|length < 1 %}
      <h4 style="text-align: center">no query - no results ...</h4>
      {% else %}
      <div class="table-responsive">
        <table class="table table-striped" id="myTable" style="width: 100%">
          <thead class="thead-dark">
            <tr>
              <th>Search</th>
              <th>Score</th>
              <th style="width: 100%">Item</th>
              <th>Score</th>
              <th>Date<!--(Project)--></th>
            </tr>
          </thead>

          <tbody>
            {% for item in items %}
            <tr>
              <td>
                <div class="container">
                  <div class="row">{{ item.search }}</div>
                </div>
              </td>
              <td>
                <div class="container">
                  <div class="row">{{ item.search_score }}</div>
                </div>
              </td>
              <td>
                <div class="container">
                  <div class="row font-weight-bold">
                    <a
                      onClick="toggle({{ item.index }}); return false;"
                      href="#"
                      >{{ item.title }}</a
                    >
                  </div>
                  <!--
                  <div class="row">
                    <div class="small">tags: <b>{{ ' '.join(item.tags) }}</b></div>
                    <div class="small">host: <b>{{ item.host }}</b></div>
                  </div>
                  {% if item.ml_libs|length > 0 %}
                  <div class="row">
                    <div class="small">
                      ml libraries: <b>{{ ' '.join(item.ml_libs) }}</b>
                    </div>
                  </div>
                  {% endif %}
                  -->

                  <div id="{{ item.index }}" class="hidden">
                    <div class="row mt-3 mb-3">
                      <div class="col-sm-2 font-weight-bold">link</div>
                      <div class="col-sm-10">
                        <a href="{{ item.link }}" target="_blank"
                          >{{ item.link }}</a
                        >
                      </div>
                      <!-- description -->
                      {% if item.description is defined and query_engines['des']
                      == 'checked' %}
                      <div class="col-sm-2 font-weight-bold">description</div>
                      <div class="col-sm-10">{{ item.description }}</div>
                      {% endif %}

                      <!-- summarization -->
                      {% if item.summarization is defined and
                      query_engines['sum'] == 'checked' %}
                      <div class="col-sm-2 font-weight-bold">summarization</div>
                      <div class="col-sm-10">{{ item.summarization }}</div>
                      {% endif %}

                      <!-- words -->
                      {% if item.words is defined %}
                      <div class="col-sm-2 font-weight-bold">length</div>
                      <div class="col-sm-10">{{ item.words }}</div>
                      {% endif %}

                      <!-- category -->
                      {% if item.category is defined %}
                      <div class="col-sm-2 font-weight-bold">category</div>
                      <div class="col-sm-10">
                        {{ item.category }} (score: {{ item.category_score }})
                      </div>
                      {% endif %}

                      <!-- subcategory -->
                      {% if item.subcategory is defined %}
                      <div class="col-sm-2 font-weight-bold">subcategory</div>
                      <div class="col-sm-10">
                        {{ item.subcategory }} (score: {{ item.subcategory_score
                        }})
                      </div>
                      {% endif %}

                      <!-- tags -->
                      {% if item.tags is defined %}
                      <div class="col-sm-2 font-weight-bold">tags</div>
                      <div class="col-sm-10">{{ ', '.join(item.tags) }}</div>
                      {% endif %}

                      <!-- kind -->
                      {% if item.kind is defined %}
                      <div class="col-sm-2 font-weight-bold">kind</div>
                      <div class="col-sm-10">{{ item.kind }}</div>
                      {% endif %}

                      <!-- libraries -->
                      {% if item.ml_libs is defined %}
                      <div class="col-sm-2 font-weight-bold">ml libs</div>
                      <div class="col-sm-10">{{ ', '.join(item.ml_libs) }}</div>
                      {% endif %}

                      <!-- host -->
                      {% if item.host is defined %}
                      <div class="col-sm-2 font-weight-bold">host</div>
                      <div class="col-sm-10">{{ item.host }}</div>
                      {% endif %}

                      <!-- license -->
                      {% if item.license is defined %}
                      <div class="col-sm-2 font-weight-bold">license</div>
                      <div class="col-sm-10">{{ item.license }}</div>
                      {% endif %}

                      <!-- language -->
                      {% if item.language is defined %}
                      <div class="col-sm-2 font-weight-bold">language</div>
                      <div class="col-sm-10">{{ item.language }}</div>
                      {% endif %}

                      <!-- date -->
                      {% if item.date_project is defined %}
                      <div class="col-sm-2 font-weight-bold">date</div>
                      <div class="col-sm-10">
                        {{ item.date_project.split('T')[0] }}
                      </div>
                      {% endif %}

                      <!-- id -->
                      {% if item.id|length > 0 %}
                      <div class="col-sm-2 font-weight-bold">id</div>
                      <div class="col-sm-10">{{ item.id }}</div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </td>
              <td>
                <div class="container">
                  <div class="row">
                    {% if item.score != None %} {{ item.score }} {% endif %}
                  </div>
                </div>
              </td>
              <td>
                <div class="container">
                  <div class="row">
                    {% if item.date_project is defined %}{{
                    item.date_project.split('T')[0] }}{% endif %}
                  </div>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    {% endif %}
  </div>
</div>
{% endblock %}
