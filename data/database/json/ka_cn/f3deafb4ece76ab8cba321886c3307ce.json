{"title": "Keras 2D model, 5-fold, log_specgram, curated only", "description": "In this notebook I present the basic keypoints of my attempt to tackle the problem. I hope you all find it helpfull. The key-points are:  I choose a np.log version of scipy.signal.spectrogram to transform 1-D audio signal to 2-D imaging. The model uses softmax activation function. During training I select random 1-seconds parts from the audio signals (see DataGenerator). I use a stratified version of k-fold based on the first class. That means that for stratification purposes I choose one of the many classes (see dictionary first_labels_set)  I calculate out-of-fold predictions (oof_y) which I use to estimate the lwlrap score. The test set is evaluated and averaged k=5 times. The evaluation is done using TestDataGenerator hence introducing some randomness and non-determinism (res_Y = model.predict_generator(test_gen, verbose=1)) The training process is optimizing categorical_crossentropy and monitors categorical_accuracy for termination. By using early stopping in each fold I implicitly introduce some overfitting on the validation set. I expect more stable estimation by using fixed number of iterations, but is is not my style :)  The whole kernel takes ~2 hours to train and a couple of minutes for inference if you use the pretrained weights I already attach.", "link": "https://www.kaggle.com/voglinio/keras-2d-model-5-fold-log-specgram-curated-only", "tags": [], "kind": ["Project", "(Notebook)"], "ml_libs": ["sklearn", "keras", "tensorflow", "pattern"], "host": "kaggle.com", "license": "Apache-2.0", "language": "english", "date_project": "2019-04-17 13:42:46", "date_scraped": "2020-12-12 20:05:18", "words": 197, "sentences": 11, "runtime": 0.005, "description_category": "Utilities", "description_category_score": 0.45844295620918274, "description_category_runtime": 20.051, "description_subcategory": "Machine Learning", "description_subcategory_score": 0.8986748456954956, "description_subcategory_runtime": 32.215, "category": "Utilities", "category_score": 0.45844295620918274, "subcategory": "Machine Learning", "subcategory_score": 0.8986748456954956, "runtime_cat": 52.266, "programming_language": "Jupyter Notebook", "ml_score": "1.0", "engagement_score": "0.694", "language_code": "en", "language_score": "0.9999978419794233", "learn_score": 1, "explore_score": 0, "compete_score": 0, "description_lemmatized": "notebook present basic keypoints attempt tackle problem hope find helpfull keypoints choose nplog version scipysignalspectrogram transform 1d audio signal 2d imaging model us softmax activation function training select random 1seconds part audio signal see datagenerator use stratified version kfold based first class mean stratification purpose choose one many class see dictionary first_labels_set calculate outoffold prediction oof_y use estimate lwlrap score test set evaluated averaged k5 time evaluation done using testdatagenerator hence introducing randomness nondeterminism res_y modelpredict_generatortest_gen verbose1 training process optimizing categorical_crossentropy monitor categorical_accuracy termination using early stopping fold implicitly introduce overfitting validation set expect stable estimation using fixed number iteration style whole kernel take 2 hour train couple minute inference use pretrained weight already attach", "tags_descriptive": []}